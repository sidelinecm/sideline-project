# =======================================================
# üèÜ NETLIFY CONFIG (MERGED SSR + SMART CACHE)
# =======================================================

[build]
  publish = "."
  command = ""

# --- 1. EDGE FUNCTIONS (‡∏£‡∏ß‡∏°‡∏£‡πà‡∏≤‡∏á SSR) ---
# ‚ö†Ô∏è ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå "netlify/edge-functions/ssr.js" ‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!

[[edge_functions]]
  function = "sitemap"
  path = "/sitemap.xml"

[[edge_functions]]
  function = "ssr"  # ‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Ñ‡∏∏‡∏°‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á
  path = "/sideline/*"

[[edge_functions]]
  function = "ssr"
  path = "/profile/*"

[[edge_functions]]
  function = "ssr"
  path = "/location/*"

[[edge_functions]]
  function = "ssr"
  path = "/province/*"

# --- 2. HEADERS (‡πÅ‡∏Å‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô 300%) ---

# ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
[[headers]]
  for = "/*"
  [headers.values]
    X-Content-Type-Options = "nosniff"
    X-Frame-Options = "SAMEORIGIN"
    X-XSS-Protection = "1; mode=block"
    Strict-Transport-Security = "max-age=63072000; includeSubDomains; preload"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "geolocation=(), camera=(), microphone=()"

# ‚úÖ HTML: ‡∏´‡πâ‡∏≤‡∏° Cache (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)
[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

# ‚úÖ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û/JS/CSS: Cache 1 ‡∏õ‡∏µ (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏õ‡∏£‡∏∑‡πä‡∏î)
[[headers]]
  for = "/images/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
    
[[headers]]
  for = "/js/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/css/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# --- 3. REDIRECTS (Routing) ---

# Force HTTPS
[[redirects]]
  from = "http://sidelinechiangmai.netlify.app/*"
  to = "https://sidelinechiangmai.netlify.app/:splat"
  status = 301
  force = true

# SPA Fallback (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏´‡πâ‡∏≤‡∏°‡∏•‡∏ö)
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
